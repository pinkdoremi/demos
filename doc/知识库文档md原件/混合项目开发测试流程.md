混合项目开发测试流程
#开发前
1. 分析交互稿，找出需要新的bridge方法和native组件的部分，提出需求[here](http://172.16.2.38/hybrid/?p=682)。
2. 是否有跳转客户端的页面，[自助查找](http://172.16.2.38/hybrid/?p=707)是否有现有的客户端跳转的规则。若无，反馈。
3. 尽量减少接口请求次数，若接口数量较多和接口商议能否合并接口。
4. 是否要做到上线后切换回native的开关这个功能请参考[这里](http://172.16.2.38/hybrid/?p=516)
##怎么用bridge
1. 引入bridge文件，例如：bridge.1.4.0.js
2. 找到你需要的方法：例如：需要调用native的请求数据的方法。找到`_tc_bridge_util.get_data`方法，查询文档[bridge1.4.0](http://61.155.197.220:5013/h5/doc/140/classes/window._tc_bridge_util.html#method_get_data)。找到调用的文档说明以及demo页面，阅读文档说明结合demo的代码可以知道具体怎么用，仍然有问题请询问hybrid组相关人员。


#开发中
1. 动手前，请阅读[项目的开发基础架构和审核规范](http://172.16.2.38/hybrid/?p=205)。
1. 项目框架搭建。参考[这里](http://172.16.2.38/hybrid/?p=902)。关于项目的框架搭建，项目应该遵循，每次的更新迭代，只更新少数需要更新的文件，因为混合增量更新会比较本机版本和服务器版本的差异来选择拉取的包，差异越小，包大小越小，下载成本越低，更
新成功率越高。
1. bridge方法调用前，应该把回调函数先声明并且赋值。因为bridge方法不是同步的，这个是肯定的。但是在ios中，他也不能说是异步的，因为它不会在你脚本结束时再执行，而会直接执行,如果回调方法回来得早，并且回调函数此时还没声明，则回调会失败。因此，把回调函数事先赋值好，然后再执行bridge方法是正确的做法。
1. 尽量让页面保持独立，尽量不要依赖其他页面，让别的地方可以跳转到该页面。eg.产品列表页。项目首页。订单详情页等等等等。。
2. 尽量使用key-value的方式在跳转链接中存放参数。`eg. /index.html?memberid=123&tag=111`
3. 单页面应用注意页面切换时，老页面的全局的回调函数（bridge的回调函数都是全局的）最好要释放。以免造成内存泄露。`eg. delete window.callbacks`。
4. 难以捕捉的问题，使用`try{}catch(e){alert(JSON.stringify(e))}`捕获效率更高。
5. 数据统计，事件跟踪，订单跟踪等请看[page,event,category](http://172.16.2.38/hybrid/?p=851)
6. hybrid的性能优化的相关方法[这里](http://172.16.2.38/hybrid/?p=65)

#开发后
1. 将项目*压缩后*进行打包。打包成zip包。[grunt构建方案](http://172.16.2.38/hybrid/?p=838)
2. [模拟打包上传](http://172.16.2.38/hybrid/?p=722),自给自足打包上传的最佳方式。
3. 发送到吴仁念、牛提罚、夏令处，上传到8008测试。

##测试流程
1. 首先内部打包并进行上述开发后的流程。
2. 如果使用了新的bridge，测试下老功能是否有问题。
3. 如果项目兼容老版本客户端，测试下老版本客户端下新混合的功能是否正常。
3. 几个常见测试点场景。1.无定位 2.定位国外 3.突然断网 4.断网无结果页面 5.会员未登录 6.会员登录 7.未开启定位 8.未开启定位并且没有任何缓存定位。
4. 对于非常复杂的功能和非常复杂的项目，建议使用单元测试保证代码正确，也可以减少在不断的迭代中修改代码造成其他意想不到的bug。

##上线流程
1. [同程客户端hybrid更新上传流程及注意点](http://172.16.2.38/hybrid/?p=429)
上传的前两天主管与hybrid负责上传同事确定好上传更新的时间点，待hybrid、UED审核通过后，hybrid相关同事负责上传，上传后一旦出现问题，有项目负责人决定是否及时回滚以减少损失。

##上线后
1. 保留每个版本（比如说，一个项目的某个版本只支持7.4，那么线上就一定会有一个7.4的版本和7.3的版本）的线上分支，以备将来对（不是最新的）某个版本进行升级。
